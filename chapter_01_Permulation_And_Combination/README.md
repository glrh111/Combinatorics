# 排列与组合

## 1.1 加法法则和乘法法则

组合数学的最主要的内容是対离散对象的计数。计数时需要用到加法和乘法两个基本法则。A， B是性质无关的两类事件。

### 1 加法法则

若具有性质A的事件有n个，具有性质B的事件有m个，则具有性质A或性质B的事件总数为m+n。

### 2 乘法法则

具有性质A的事件n个，具有性质B的事件m个，那么具有性质A及性质B的事件有 mn 个。

## 1.2 一一对应（不明觉历）

若性质A的计数比较困难，性质B的计数比较容易，但性质A和性质B一一对应，则対A的计数，可转换为対B的计数。

> 定理 1-1 Cayley 过n个有标致顶点的树的树目等于n^(n-2)。

此定理说明，用n-1条边，将n个已知的顶点连接起来的连通图的个数为 n^(n-2) 个。

## 1.3 排列组合

### 1.3.1 排列与组合模型

从n中取r的组合，方案数为 C(n, r), 排列的方案数为 P(n, r)

P(n, r) = n!/(n-r)!

C(n, r) = P(n, r) / r!

全排列 0! = 1

### 1.3.2 排列与组合问题举例

#### 例子 1-13 

5面不同颜色的旗帜，20中不同的花盆，排成两端是两面旗帜，中间放3盆花的形式，总方案数？

P(5, 2) * P(20, 3) = 5 * 4 * 20 * 19 * 18 = 136800

#### 例子 1-14

男运动员7名，女运动员3名，列队进场，若要求头尾两名运动员是男，且女运动员不相邻，方案数？

7! * 6 * 5 * 4

看作先排列男运动员， m1()m2()m3()m4()m5()m6()m7 然后将女运动员插入其中

#### 例子 1-15 

[2000, 70000] 之间的偶数，由不同数字组成的4位数的个数：

数字表示为 n3,n2,n1,n0

n0可取 0, 2, 4, 6, 8 五个，n3 可取 2, 3, 4, 5, 6 五个。

+ n3 取偶数，2,4,6, 那么n0少了一种可能 3 * 4 * 8 * 7 = 672
+ n3 不取偶数，3,5, 那么不影响 n0, 2 * 5 * 8 * 7 = 560

共计 672 + 560 = 1232

#### 例子 1-16 

1,3,5,7 不重复出现，组成的整数的和。

最多4位数 1+3+5+7 = 16 .

+ 4位 全排列 P(4) 种方式。3!*1111*(1+3+5+7)     = 106656 
+ 3位 全排列 C(4, 3) 种方式。2!*111*(1+3+5+7)*3 = 10656
+ 2位 全排列 C(4, 2) 种方式。    11*(1+3+5+7)*3 = 528
+ 1位 全排列 C(4, 1) 种方式。     1*(1+3+5+7)   = 16

共计 117856

#### 例子 1-17

5个女生，7个男生要组成含5个人的小组，要求该小组不允许某男生和某女生同时参加：

C(12, 5) - C(10, 3) = ...

#### 例子 1-18

英文 wellcome ，将这8个字母进行排列，要求3个原音不想邻，排列方式？

()f()f()f()f()f() 辅音字母 w,l,l,c,m 元音字母 e,o,e

5! * 6 * 5 * 4 / 2! / 2! = 3600

#### 例子 1-19

[1,300] 中选取3个数，使他们的和正好被3除尽，试问有多少种方案？

+ 余数为0, 1, 2 的各 100 个

+ 三个数都能被 3 除 C(100, 3) 
+ 三个都余 1       C(100, 3)
+ 三个都余 2       C(100, 3)
+ 一个余 1 一个余 2 一个整除 100 * 100 * 100

#### 例子 1-20 

RYBG 四个颜色的旗帜各4面，共16面排成一列，有多少种不同的方案？ 16! / (4!)^4

#### 例子 1-21 

用 1*1, 1*2, 1*3 的方块铺设 1*7 的模块，有多少种模式？

在电脑上可以递归解决。

+ 7 * 1
+ 1 * 1 + 3 * 2
+ 2 * 3 + 1
+ 
... 慢慢列举吧

#### 例子 1-22 

设 A[1,8] 8个同志，共分4组，每组两人，问有多少方案？

8！/(2!)^4/4! = 105 

组和组之间，以及组内，都有重复度。

#### 例子 1-24

求5位数中，至少出现1个6,而且被3除进的数的数目。

≡ 表示同余。

+ 被3除尽的数的总数量 [10000, 99999] 一共有 (99999 - 10000 + 1) / 3 = 30000 个
+ 1个6都没有的 8 * 9^3 * 3 = 17496
  + 前4位好选
  + 如果前4位之和 mod 3 == 0, 0 3 9
  + 如果前4位之和 mod 3 == 1, 2 5 8
  + 如果前4位之和 mod 3 == 2, 1 4 7

所以剩余 12504 个

## 1.4 圆周排列

将一个排列搞到圆周上，造成了排列的一些重复度。

一个长度为 r 的圆周排列，有 r 种重复度。

所以， Q(n, r) = P(n, r) / r

Q(5, 3) = P(5, 3) / 3 = 5! / 2! / 3 = 20

#### 例子 1-25 

5个男生，3个女生，围一个圆桌而坐。Q(8, 8) = P(8, 8) / 8 = 7! = 5040

若某男生某女生不能相邻？相邻的情况有 7! / 6 * 2 = 2 * 6! = 1440 相减得 3600 

三位女生不相邻: 5个男生先排列 4! 三个女生插入其中 P(5, 3) = 5!/2! 所以共计 4! * 5! / 2 = 1440

#### 例子 1-26

n対夫妻围一圆桌而坐，求每対夫妻相邻而坐的方案数：

n!/n*2^n

## 1.5 排列的生成算法

### 1.5.1 序数法

n! = n(n-1)! = [(n-1) + 1] * (n-1)! 
   = (n-1)(n-1)! + (n-1)!
   = (n-1)(n-1)! + (n-2)(n-2)! + (n-2)!
   = (n-1)(n-1)! + (n-2)(n-2)! + (n-3)(n-3)! + ... + 2 * 2! + 1 * 1! + 1
   = Sigma(1, n-1) k * k! + 1
   
那么，0 ~ n! - 1 的整数 m 可以唯一的表示为:

m = a_(n-1)(n-1)! + a_(n-2)(n-2)! + ... + ... + a_1

其中 a_k 满足 0 <= a_k <= k, k 属于 [1, n-1] 

所以可以证明，0 ~ n!-1 的 n! 个整数和序数 

(a_n-1, a_n-2, ..., a_1) 一一对应。

下面讨论从 m 求序数的方法：

a_1 = m % 2, m2 = floor(m/2)   每次除得的余数，为 a_i

a_2 = m2 % 3, m3 = floor(m/3)

... 

下面试图将 序数 (a_n-1, a_n-2, ..., a1) 与 n! 个全排列一一(用 [1, ..., n] n 个数表示)对应，这样就求出了 n! 个全排列。

+ a_n-1 代表 排列中 n 右侧比n小的数的数量
+ a_n-2 代表 排列中 n-1 右侧比n-1 小的数的数量
+ a_i 代表 排列中 i+1 右侧比 i+1 小的树的数量

具体示例 排列 4213 n = 4 可以用 3位序数表示。
+ n=4 右侧比n小的数量为 3, a_3=3
+ n-1=3 右侧比n小的数量为 0, a_2=0
+ n-2=2 右侧比n小的数量为 1, a_1=1
+ 所以 4213 这个排列对应的序数为 301

看了半天，不知道怎么反推过去？

### 1.5.2 字典序法

![字典序法](http://o9hjg7h8u.bkt.clouddn.com/1-11%E5%AD%97%E5%85%B8%E5%BA%8F%E6%B3%95.png)

由前面一个排列 p1p2p3p4 到下一个排列的生成算法如下：

+ S1 求满足关系式 p_(j-1) < p_j 的最大值，设为 i，即 i = max{j | p_(j-1) < p_j}
+ S2 求满足关系式 p_(i-1) < p_k 的k的最大值，设为 h, 即 h = max{k | p_(i-1) < p_k}
+ S3 p_(i-1)与p_h 互换，得到 p1'p2'...pn'
+ S4 令 p1'p2'...p_(i-1)'p_i'p_(i+1)'...p_n 中 i ~ n 的顺序逆转，即得到下一个排列

### 1.5.3 换位法

看得头疼。不明觉历。

## 1.6 允许重复的组合与不相邻的组合

### 1.6.1 允许重复的组合 

允许重复的组合，是指允许组合中的元素可以重复。即多次取同一个元素。

+ 允许重复的组合模型是：r个球是无标志的，n个盒子是有区别的，取出r个球放进盒子，每个盒子允许多余一个球
+ 不允许重复的组合模型是：每个盒子一个球 

> 定理 1-2 在n个不同元素中，取r个做允许重复的组合，组合数为 C(n+r-1, r)

相当于从 n+r-1 个元素中，取r个不允许重复的组合数。

#### 例子 1-29 

求 (x+y+z)^4 有多少项？

可以看作 4 个无标志的球，放进三个有标志的盒子里 x,y,z, 每个盒子可以方多于一个的球。

那么 n = 3, r = 4, C(6, 4) = 15  


### 1.6.2 不相邻的组合

> 定理 1-3  A={1,2,3,...,n} 中，取r个不相邻的数的组合数为 C(n-r+1, r)

证明方法，与允许重复的组合类似。

设 b1,b2,...,br 是这样一个组合，那么有 

b1 < b2 < b3 < ... < br

令 c1 = b1, c2 = b2-1, ..., cr = br-(r-1) <= n-(r-1)

而且有 c1 < c2 < ... < cr 所以： c1,c2,...,c3 相当于 C(n-r+1, r) 

得证。

### 1.6.3 线性方程的整数解的个数问题

已知线性方程 x1 + x2 + x3 + ... + xn = b, n, b 都是整数，n>=1, 求非负整数解的个数。

> 定理 1-4 上述方程非负整数解的个数为 C(n+b-1, b)

这个问题相当于，将 b 个球，放入 n 个盒子里，允许重复放。

那么 n=n, r=b, 所以组合数一共有 C(n+b-1, b)

### 1.6.4 组合的生成

生成算法如下：

一致 c1,c2,...,cr 为一组允许重复的组合，不妨假定 c1<c2<...<cr<=n, 那么c_(r-1) <= n-1, c_(r-2) <= n-2 ..., c1 <=n-r+1 . ci <= n-r+j

+ S1: 求满足 cj < n-r+j, 使j的值达到最大，设 i = max{j | cj < n-r+j}. 如果找不到，中止.
+ S2: ci <- (ci)+1
+ S3: cj <- (cj-1) + 1, j = i+1, i+2, ..., r

## 1.7 组合意义的解释

#### 例子 1-30

从出发地到目的地，需要向右走n条路，向上走m条路，那么一共有几种走法？

C(m+n, n) == C(m+n, m)

#### 例子 1-31 

证明 C(m+n, n) == C(m+n, m)

一一对应的关系。

#### 例子 1-32 

证明 C(n, r) = C(n-1, r) + C(n-1, r-1) 杨辉三角，帕斯卡三角

![杨辉三角](http://o9hjg7h8u.bkt.clouddn.com/1-15%E6%9D%A8%E8%BE%89%E4%B8%89%E8%A7%92.png)

从n个元素中，选出r个，相当于下面的和
+ 选第一个元素 C(n-1, r-1)
+ 不选第一个元素 C(n-1, r)

#### 例子 1-33 

C(n+r+1, r) = C(n+r, r) + C(n+r-1, r-1) + ... + C(n+1, 1) + C(n, 0)

#### 例子 1-34 

C(n, l) * C(l, r) = C(n, r) * C(n-r, l-r)

右边第二项，相当于重复度。

#### 例子 1-35

C(m, 0) + C(m, 1) + ... + C(m, m) = 2^m

组合意义之一:

(x+y)^m = ... 二项式展开为左边的。将x=y=1 带入，可以得证。

组合意义之二：

从 (m, 0) 到 (0, m) 的路径总和.

#### 例子 1-36

0 = C(n, 0) - C(n, 1) + C(n, 2) - ..... +- C(n, n)

可以通过二项式定理证明。x,y 代入为 1, -1

组合意义为：从 n 个元素中，取奇数个元素的组合数，等于取偶数个元素(包含0)的组合数。

加入集合中的某个元素为a，那么对于a来说，所有组合有含有和不含a之分。所以，如果一个奇数组合，加上a或者减去a，就可以得到一个偶数组合。所以是意义对应的。

含a不含a的组合数是相同的。

Page 26 有空慢慢看，看得头疼

## 1.9 Stirling 公式

斯特林给出求n的近似公式：

![Stirling公式](http://o9hjg7h8u.bkt.clouddn.com/1.9Stirling%E5%85%AC%E5%BC%8F.png)






